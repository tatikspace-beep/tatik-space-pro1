services:
  - type: web
    name: tatik-space-api
    runtime: node
    plan: free
    
    # Build command - install pnpm via corepack, then build
    buildCommand: corepack enable pnpm && pnpm install --frozen-lockfile && pnpm run build
    
    # Start command - runs the Express server
    startCommand: pnpm run start:render
    
    # Environment
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
    
    # Connect to PostgreSQL database
    databases:
      - name: tatik_space_db
        plan: free
        
    # Auto-deploy from GitHub on push to main
    github:
      branch: main
